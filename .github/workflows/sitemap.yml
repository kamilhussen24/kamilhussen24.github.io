name: Auto Sitemap Update

on:
  schedule:
    - cron: "0 0 * * 5"  # ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∂‡ßÅ‡¶ï‡ßç‡¶∞‡¶¨‡¶æ‡¶∞ ‡¶∞‡¶æ‡¶§ ‡ßß‡ß®‡¶ü‡¶æ‡ßü ‡¶ö‡¶≤‡¶¨‡ßá
  workflow_dispatch:     # ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡ßü‡¶æ‡¶≤ ‡¶∞‡¶æ‡¶® ‡¶Ö‡¶™‡¶∂‡¶®

permissions:
  contents: write

jobs:
  update-sitemap:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          ref: main

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.x"

      - name: Generate Sitemap
        run: python .github/scripts/generate_sitemap.py

      - name: Commit & Push Changes
        run: |
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"
          git config --global pull.rebase false  # ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡ßü‡¶æ‡¶≤ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ü‡ßá‡¶ú‡¶ø
          
          # ‡¶∏‡ßç‡¶ü‡ßá‡¶ú‡¶ø‡¶Ç ‡¶è‡¶¨‡¶Ç ‡¶ï‡¶Æ‡¶ø‡¶ü
          git add sitemap.xml
          git commit -m "üîÑ Auto-updated sitemap [skip it]" || echo "No changes"
          
          # ‡¶∞‡¶ø‡¶Æ‡ßã‡¶ü‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï‡ßç‡¶∞‡ßã‡¶®‡¶æ‡¶á‡¶ú
          git fetch origin main
          git pull origin main
          
          # ‡¶ú‡ßã‡¶∞‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶ï ‡¶™‡ßÅ‡¶∂ (‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá)
          git push origin main
